@model WebApplication3.Models.ServiceOrder
@{
    ViewData["Title"] = "Thêm Dịch Vụ Mới";
}

<div class="main-layout">
    <aside class="sidebar">
        <div style="padding: 24px; text-align: center;">
            <div style="font-size: 18px; font-weight: 800; color: #1e293b;">Quản lý Sân Tập</div>
            <div style="font-size: 16px; color: var(--primary-color); font-weight: 600;">The Hunter</div>
        </div>

        <nav class="sidebar-menu">
            <p style="font-size: 12px; color: var(--text-muted); padding: 0 16px; margin-bottom: 8px;">Menu quản lý</p>
            <a href="#" class="menu-item">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
                Dashboard
            </a>
            <a asp-controller="Court" asp-action="Index" class="menu-item">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                Quản lý sân
            </a>
            <a asp-controller="Staff" asp-action="Index" class="menu-item">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                Quản lý nhân sự
            </a>

            <a asp-controller="Booking" asp-action="Index" class="menu-item">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path>
                </svg>
                Đăng ký vé
            </a>

            <a asp-controller="Order" asp-action="Index" class="menu-item active">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                Yêu cầu thêm
            </a>

            <a href="#" class="menu-item">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                </svg>
                Kho hàng
            </a>
        </nav>
    </aside>

    <main class="content-area">
        <div>
            <h1 style="font-size: 24px; font-weight: 700;">Dịch vụ & Gọi đồ</h1>
            <p style="color: #64748b;">Quản lý yêu cầu phục vụ tại các sân</p>
        </div>

        <div class="data-card" style="padding: 30px; background: white; max-width: 800px; border-radius: 12px;">
            <form asp-action="Create" method="post" id="orderForm">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="display:block; margin-bottom:8px; font-weight:600;">Khách hàng</label>
                        <input asp-for="CustomerName" class="form-control" style="width:100%;" required />
                    </div>
                    <div>
                        <label style="display:block; margin-bottom:8px; font-weight:600;">Vị trí sân</label>
                        <select asp-for="CourtName" class="form-control" style="width:100%;">
                            @for (int i = 1; i <= 8; i++)
                            {
                                <option value="Sân @i">Sân @i</option>
                            }
                        </select>
                    </div>
                </div>

                <div id="itemsContainer">
                    <label style="display:block; margin-bottom:12px; font-weight:600;">Danh sách đồ chọn</label>
                    <div class="item-row" style="display: flex; gap: 10px; margin-bottom: 10px; align-items: center;">
                        <select asp-for="ItemName" class="form-control item-select" style="flex: 2;" onchange="calculateTotal()">
                            <option value="" data-price="0">-- Chọn đồ --</option>
                            <option value="Nước suối" data-price="10000">Nước suối (10k)</option>
                            <option value="Bia tập" data-price="25000">Bia tập (25k)</option>
                            <option value="Mũi tên" data-price="50000">Mũi tên (50k)</option>
                            <option value="Khăn lạnh" data-price="5000">Khăn lạnh (5k)</option>
                        </select>
                        <input asp-for="Quantity" type="number" class="form-control item-quantity" value="1" min="1" style="flex: 0.5;" onchange="calculateTotal()" oninput="calculateTotal()" />
                        <span class="item-subtotal" style="flex: 1; font-weight: 600; text-align: right;">0đ</span>
                    </div>
                </div>

                <div style="margin-top: 24px; padding-top: 20px; border-top: 2px dashed #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <span style="font-size: 18px; color: #64748b;">Tổng cộng:</span>
                        <span id="grandTotal" style="font-size: 24px; font-weight: 800; color: #2962ff; margin-left: 10px;">0đ</span>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <a asp-action="Index" class="btn-action-danger" style="text-decoration:none; width: auto; padding: 10px 20px;">Hủy</a>
                        <button type="submit" class="btn-submit" style="background:#2962ff; border:none; color:white; padding:10px 30px; border-radius:8px; cursor:pointer; font-weight:700;">XÁC NHẬN ĐƠN</button>
                    </div>
                </div>
            </form>
        </div>
    </main>
</div>

<script>
        function calculateTotal() {
        let grandTotal = 0;

        document.querySelectorAll('.item-row').forEach(row => {
            const select = row.querySelector('.item-select');
            const quantity = row.querySelector('.item-quantity').value || 1;
            const price = select.options[select.selectedIndex].getAttribute('data-price') || 0;

            const subtotal = parseInt(price) * parseInt(quantity);
            row.querySelector('.item-subtotal').innerText = subtotal.toLocaleString() + 'đ';

            if (subtotal > 0) {
                grandTotal += subtotal;
            }
        });

        document.getElementById('grandTotal').innerText = grandTotal.toLocaleString() + 'đ';
    }

    // Khởi tạo tính toán ban đầu
    calculateTotal();
</script>